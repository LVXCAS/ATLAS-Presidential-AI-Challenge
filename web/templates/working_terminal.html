<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hive Trade Working Terminal</title>
    
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000000;
            color: #ffffff;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow: hidden;
            height: 100vh;
        }
        
        .terminal {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            grid-template-rows: 40px 1fr 30px;
            height: 100vh;
            gap: 1px;
        }
        
        .header {
            grid-column: 1 / -1;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid #333;
        }
        
        .logo {
            color: #ff6600;
            font-weight: bold;
            font-size: 16px;
        }
        
        .status {
            margin-left: auto;
            color: #00ff00;
        }
        
        .sidebar, .main, .right-panel {
            background: #0a0a0a;
            border: 1px solid #333;
            overflow-y: auto;
        }
        
        .section-title {
            background: #1a1a1a;
            color: #ff6600;
            padding: 10px;
            font-weight: bold;
            border-bottom: 1px solid #333;
        }
        
        .watchlist-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 10px;
            border-bottom: 1px solid #222;
            cursor: pointer;
        }
        
        .watchlist-item:hover {
            background: #1a1a1a;
        }
        
        .symbol {
            font-weight: bold;
        }
        
        .price-up { color: #00ff00; }
        .price-down { color: #ff0000; }
        
        .portfolio-value {
            padding: 20px;
            text-align: center;
        }
        
        .portfolio-amount {
            font-size: 24px;
            color: #00ff00;
            margin-bottom: 10px;
        }
        
        .portfolio-change {
            font-size: 14px;
        }
        
        .main-content {
            padding: 20px;
        }
        
        .current-symbol {
            font-size: 20px;
            margin-bottom: 20px;
            color: #ff6600;
        }
        
        .price-display {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .change-display {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .trade-buttons {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        
        .btn-buy {
            background: #00ff00;
            color: #000;
        }
        
        .btn-sell {
            background: #ff0000;
            color: #fff;
        }
        
        .positions-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .positions-table th,
        .positions-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        
        .positions-table th {
            background: #1a1a1a;
            color: #ff6600;
        }
        
        .news-item {
            padding: 10px;
            border-bottom: 1px solid #222;
        }
        
        .news-headline {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .news-time {
            color: #888;
            font-size: 10px;
        }
        
        .footer {
            grid-column: 1 / -1;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-top: 1px solid #333;
            font-size: 10px;
            color: #888;
        }
        
        .connection-status {
            margin-right: 20px;
        }
        
        .connected { color: #00ff00; }
        .disconnected { color: #ff0000; }
    </style>
</head>
<body>
    <div class="terminal">
        <!-- Header -->
        <div class="header">
            <div class="logo">HIVE TRADE TERMINAL</div>
            <div class="status" id="connectionStatus">CONNECTING...</div>
        </div>
        
        <!-- Left Sidebar - Watchlist -->
        <div class="sidebar">
            <div class="section-title">WATCHLIST</div>
            <div id="watchlist">
                <div class="watchlist-item" onclick="selectSymbol('SPY')">
                    <span class="symbol">SPY</span>
                    <span id="spy-price" class="price-up">$420.00</span>
                </div>
                <div class="watchlist-item" onclick="selectSymbol('QQQ')">
                    <span class="symbol">QQQ</span>
                    <span id="qqq-price" class="price-up">$350.00</span>
                </div>
                <div class="watchlist-item" onclick="selectSymbol('AAPL')">
                    <span class="symbol">AAPL</span>
                    <span id="aapl-price" class="price-up">$175.00</span>
                </div>
                <div class="watchlist-item" onclick="selectSymbol('GOOGL')">
                    <span class="symbol">GOOGL</span>
                    <span id="googl-price" class="price-up">$2800.00</span>
                </div>
                <div class="watchlist-item" onclick="selectSymbol('MSFT')">
                    <span class="symbol">MSFT</span>
                    <span id="msft-price" class="price-up">$380.00</span>
                </div>
            </div>
        </div>
        
        <!-- Main Content - Current Symbol -->
        <div class="main">
            <div class="main-content">
                <div class="current-symbol" id="currentSymbol">SPY US EQUITY</div>
                <div class="price-display price-up" id="currentPrice">$420.00</div>
                <div class="change-display price-up" id="currentChange">+$2.45 (+0.58%)</div>
                
                <div class="trade-buttons">
                    <button class="btn btn-buy" onclick="executeTrade('BUY')">BUY</button>
                    <button class="btn btn-sell" onclick="executeTrade('SELL')">SELL</button>
                </div>
                
                <div style="margin-top: 30px;">
                    <div class="section-title">RECENT SIGNALS</div>
                    <div id="aiSignals">
                        <div style="padding: 10px; color: #00ff00;">
                            ✓ AI SIGNAL: BUY SPY - Confidence: 85%<br>
                            Strong momentum pattern detected
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Right Sidebar - Portfolio & News -->
        <div class="right-panel">
            <div class="section-title">PORTFOLIO</div>
            <div class="portfolio-value">
                <div class="portfolio-amount" id="portfolioValue">$1,000,000</div>
                <div class="portfolio-change price-up" id="portfolioChange">+$12,450 (+1.25%)</div>
            </div>
            
            <div class="section-title">POSITIONS</div>
            <table class="positions-table">
                <thead>
                    <tr>
                        <th>Symbol</th>
                        <th>Qty</th>
                        <th>P&L</th>
                    </tr>
                </thead>
                <tbody id="positionsTable">
                    <tr>
                        <td>AAPL</td>
                        <td>100</td>
                        <td class="price-up">+$1,250</td>
                    </tr>
                    <tr>
                        <td>GOOGL</td>
                        <td>50</td>
                        <td class="price-up">+$2,100</td>
                    </tr>
                    <tr>
                        <td>MSFT</td>
                        <td>75</td>
                        <td class="price-down">-$450</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="section-title" style="margin-top: 20px;">NEWS</div>
            <div id="newsFeed">
                <div class="news-item">
                    <div class="news-headline">Fed Signals Rate Cut</div>
                    <div class="news-time">10:30 AM</div>
                </div>
                <div class="news-item">
                    <div class="news-headline">Tech Stocks Rally</div>
                    <div class="news-time">10:15 AM</div>
                </div>
                <div class="news-item">
                    <div class="news-headline">Oil Prices Surge 3%</div>
                    <div class="news-time">09:45 AM</div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <div class="connection-status connected" id="footerStatus">● CONNECTED</div>
            <div>Market: OPEN</div>
            <div style="margin-left: 20px;">Updates: <span id="updateCount">0</span></div>
            <div style="margin-left: 20px;">Time: <span id="currentTime">00:00:00</span></div>
        </div>
    </div>

    <script>
        let socket;
        let currentSymbolSelected = 'SPY';
        let updateCounter = 0;
        let connected = false;
        
        // Market data storage
        const marketData = {
            'SPY': { price: 420.00, change: 2.45, changePercent: 0.58 },
            'QQQ': { price: 350.00, change: -1.25, changePercent: -0.36 },
            'AAPL': { price: 175.00, change: 3.20, changePercent: 1.83 },
            'GOOGL': { price: 2800.00, change: -15.50, changePercent: -0.55 },
            'MSFT': { price: 380.00, change: 4.75, changePercent: 1.27 }
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Hive Trade Working Terminal Starting...');
            initializeSocket();
            startClock();
            startDataSimulation();
            updateDisplay();
        });
        
        // Socket connection
        function initializeSocket() {
            socket = io();
            
            socket.on('connect', function() {
                console.log('Connected to server');
                connected = true;
                document.getElementById('connectionStatus').textContent = 'LIVE';
                document.getElementById('connectionStatus').className = 'status connected';
                document.getElementById('footerStatus').textContent = '● CONNECTED';
                document.getElementById('footerStatus').className = 'connection-status connected';
                
                // Request initial data
                socket.emit('get_portfolio');
                socket.emit('get_watchlist', { symbols: Object.keys(marketData) });
            });
            
            socket.on('disconnect', function() {
                console.log('Disconnected from server');
                connected = false;
                document.getElementById('connectionStatus').textContent = 'OFFLINE';
                document.getElementById('connectionStatus').className = 'status disconnected';
                document.getElementById('footerStatus').textContent = '● DISCONNECTED';
                document.getElementById('footerStatus').className = 'connection-status disconnected';
            });
            
            socket.on('market_data', function(data) {
                console.log('Received market data:', data);
                updateMarketData(data);
            });
            
            socket.on('portfolio_update', function(data) {
                console.log('Received portfolio update:', data);
                updatePortfolioDisplay(data);
            });
            
            socket.on('trade_executed', function(data) {
                console.log('Trade executed:', data);
                if (data.success) {
                    alert(`Trade executed: ${data.message}`);
                }
            });
        }
        
        // Update market data
        function updateMarketData(data) {
            Object.keys(data).forEach(symbol => {
                if (marketData[symbol]) {
                    marketData[symbol] = data[symbol];
                    
                    // Update watchlist display
                    const priceEl = document.getElementById(`${symbol.toLowerCase()}-price`);
                    if (priceEl) {
                        priceEl.textContent = `$${data[symbol].price.toFixed(2)}`;
                        priceEl.className = data[symbol].change >= 0 ? 'price-up' : 'price-down';
                    }
                }
            });
            
            updateDisplay();
            updateCounter++;
            document.getElementById('updateCount').textContent = updateCounter;
        }
        
        // Update portfolio display
        function updatePortfolioDisplay(data) {
            if (data.totalValue) {
                document.getElementById('portfolioValue').textContent = `$${data.totalValue.toLocaleString()}`;
            }
            if (data.dayPnL !== undefined) {
                const changeEl = document.getElementById('portfolioChange');
                const sign = data.dayPnL >= 0 ? '+' : '';
                changeEl.textContent = `${sign}$${data.dayPnL.toLocaleString()}`;
                changeEl.className = `portfolio-change ${data.dayPnL >= 0 ? 'price-up' : 'price-down'}`;
            }
        }
        
        // Select symbol
        function selectSymbol(symbol) {
            currentSymbolSelected = symbol;
            updateDisplay();
            console.log(`Selected symbol: ${symbol}`);
        }
        
        // Update main display
        function updateDisplay() {
            const data = marketData[currentSymbolSelected];
            if (!data) return;
            
            document.getElementById('currentSymbol').textContent = `${currentSymbolSelected} US EQUITY`;
            document.getElementById('currentPrice').textContent = `$${data.price.toFixed(2)}`;
            document.getElementById('currentPrice').className = `price-display ${data.change >= 0 ? 'price-up' : 'price-down'}`;
            
            const sign = data.change >= 0 ? '+' : '';
            document.getElementById('currentChange').textContent = `${sign}$${data.change.toFixed(2)} (${sign}${data.changePercent.toFixed(2)}%)`;
            document.getElementById('currentChange').className = `change-display ${data.change >= 0 ? 'price-up' : 'price-down'}`;
        }
        
        // Execute trade
        function executeTrade(side) {
            if (!connected) {
                alert('Not connected to server');
                return;
            }
            
            const data = {
                symbol: currentSymbolSelected,
                side: side,
                quantity: 100,
                price: marketData[currentSymbolSelected].price
            };
            
            console.log(`Executing ${side} order for ${currentSymbolSelected}`);
            socket.emit('execute_trade', data);
        }
        
        // Start clock
        function startClock() {
            function updateClock() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString();
                document.getElementById('currentTime').textContent = timeStr;
            }
            
            updateClock();
            setInterval(updateClock, 1000);
        }
        
        // Start data simulation
        function startDataSimulation() {
            setInterval(() => {
                // Simulate price changes
                Object.keys(marketData).forEach(symbol => {
                    const data = marketData[symbol];
                    const volatility = 0.001;
                    const change = (Math.random() - 0.5) * data.price * volatility;
                    
                    data.price = Math.max(data.price + change, 0.01);
                    data.change += change;
                    data.changePercent = (data.change / (data.price - data.change)) * 100;
                    
                    // Update watchlist display
                    const priceEl = document.getElementById(`${symbol.toLowerCase()}-price`);
                    if (priceEl) {
                        priceEl.textContent = `$${data.price.toFixed(2)}`;
                        priceEl.className = data.change >= 0 ? 'price-up' : 'price-down';
                        
                        // Flash effect
                        priceEl.style.backgroundColor = change >= 0 ? '#003300' : '#330000';
                        setTimeout(() => {
                            priceEl.style.backgroundColor = 'transparent';
                        }, 200);
                    }
                });
                
                updateDisplay();
                updateCounter++;
                document.getElementById('updateCount').textContent = updateCounter;
                
            }, 2000); // Update every 2 seconds
        }
        
        console.log('Hive Trade Working Terminal Ready');
    </script>
</body>
</html>