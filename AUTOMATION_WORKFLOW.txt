================================================================================
                    AUTOMATED STARTUP WORKFLOW
                   Visual Guide to System Operation
================================================================================


SETUP WORKFLOW (ONE-TIME):
===========================

    [User]
      |
      | Right-click SETUP_AUTOMATED_STARTUP.bat
      | Select "Run as administrator"
      v
    [Windows Admin Prompt]
      |
      | Create Scheduled Tasks
      v
    ┌─────────────────────────────────────────────────────────────┐
    │  Windows Task Scheduler                                     │
    │                                                              │
    │  Task 1: "PC-HIVE Auto Scanner"                            │
    │    Trigger: Daily at 6:30 AM PT                            │
    │    Action:  START_TRADING_BACKGROUND.bat                   │
    │                                                              │
    │  Task 2: "PC-HIVE Auto Scanner - Startup"                  │
    │    Trigger: System startup (1 min delay)                   │
    │    Action:  START_TRADING_BACKGROUND.bat                   │
    └─────────────────────────────────────────────────────────────┘
      |
      | SETUP COMPLETE
      v
    [Scanner Ready - Fully Automated]


DAILY AUTOMATED WORKFLOW:
==========================

    ┌─────────────────────────┐
    │   6:30 AM PT Daily      │
    │   Windows Clock         │
    └─────────────────────────┘
              |
              | Trigger scheduled task
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Windows Task Scheduler                                    │
    │   Executes: START_TRADING_BACKGROUND.bat                   │
    └─────────────────────────────────────────────────────────────┘
              |
              | Launch Python script
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   auto_options_scanner.py --daily                           │
    │   Mode: Daily morning scan at market open                   │
    └─────────────────────────────────────────────────────────────┘
              |
              | Initialize scanner
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Scanner Initialization                                    │
    │   - Load previous status                                    │
    │   - Reset daily counter if new day                          │
    │   - Check trade limits                                      │
    └─────────────────────────────────────────────────────────────┘
              |
              | Check conditions
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Pre-Scan Checks                                           │
    │   ✓ Is today a weekday? (Mon-Fri)                          │
    │   ✓ Is it market hours? (6:30 AM - 1:00 PM PT)            │
    │   ✓ Have we hit daily limit? (< 4 trades today)           │
    └─────────────────────────────────────────────────────────────┘
              |
              | All checks passed
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Market Scan                                               │
    │   - Initialize MondayAITrading system                       │
    │   - Scan S&P 500 stocks                                    │
    │   - Fetch options data                                      │
    │   - Calculate technical indicators                          │
    └─────────────────────────────────────────────────────────────┘
              |
              | Analyze opportunities
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   AI Scoring                                                │
    │   - Calculate confidence scores                             │
    │   - Evaluate risk/reward                                    │
    │   - Rank opportunities                                      │
    │   - Filter by min_score >= 8.0                             │
    └─────────────────────────────────────────────────────────────┘
              |
              | Execute trades
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Trade Execution (if score >= 8.0)                        │
    │   - Place orders via Alpaca API                             │
    │   - Update positions                                        │
    │   - Increment trade counter                                 │
    │   - Log all activity                                        │
    └─────────────────────────────────────────────────────────────┘
              |
              | Save results
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Update Status Files                                       │
    │   - auto_scanner_status.json (stats)                       │
    │   - logs/scanner_TIMESTAMP.log (details)                   │
    └─────────────────────────────────────────────────────────────┘
              |
              | Schedule next run
              v
    ┌─────────────────────────────────────────────────────────────┐
    │   Wait for Tomorrow                                         │
    │   Scanner stays running, waits for 6:30 AM PT tomorrow     │
    └─────────────────────────────────────────────────────────────┘
              |
              | Repeat daily
              v
           [Loop Back]


MANUAL START WORKFLOW:
=======================

    [User]
      |
      | Double-click START_TRADING.bat
      v
    [Visible Console Window]
      |
      | Shows live output
      | Creates timestamped log
      v
    [Same scan process as automated]
      |
      | User can watch progress
      | Press Ctrl+C to stop
      v
    [Scanner Running]


MONITORING WORKFLOW:
====================

    [User wants to check status]
      |
      | Double-click CHECK_SCANNER_STATUS.bat
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   Status Check Script                                       │
    │                                                              │
    │   Checking:                                                 │
    │   1. Running processes (python.exe/pythonw.exe)            │
    │   2. Status file (auto_scanner_status.json)                │
    │   3. Recent log files (logs/*.log)                         │
    │   4. Scheduled tasks                                        │
    └─────────────────────────────────────────────────────────────┘
      |
      | Display results
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   Status Report                                             │
    │   ✓ Scanner is RUNNING                                     │
    │   ✓ Trades today: 2/4                                      │
    │   ✓ Total trades: 12                                       │
    │   ✓ Next run: Tomorrow at 6:30 AM PT                       │
    │   ✓ Scheduled tasks: Enabled                               │
    └─────────────────────────────────────────────────────────────┘


STOP WORKFLOW:
==============

Normal Stop:
------------
    [User]
      |
      | Double-click STOP_SCANNER.bat
      v
    [Graceful Shutdown]
      |
      | Kill python.exe/pythonw.exe processes
      | Save current status
      v
    [Scanner Stopped]

Emergency Stop:
---------------
    [User - EMERGENCY]
      |
      | Double-click EMERGENCY_STOP.bat
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   EMERGENCY PROCEDURES                                      │
    │   1. Kill ALL Python processes immediately                  │
    │   2. Disable scheduled tasks                                │
    │   3. Create emergency_stop.flag                            │
    │   4. Prevent new trades                                     │
    └─────────────────────────────────────────────────────────────┘
      |
      | ALL TRADING STOPPED
      v
    [System Locked Down]


ERROR HANDLING WORKFLOW:
=========================

    [Error Occurs During Scan]
      |
      | Exception caught
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   Error Handler                                             │
    │   - Log error details                                       │
    │   - Save current state                                      │
    │   - Don't crash scanner                                     │
    └─────────────────────────────────────────────────────────────┘
      |
      | Continue operation
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   Recovery                                                  │
    │   - Scanner keeps running                                   │
    │   - Will retry on next scheduled scan                       │
    │   - User can check logs for details                         │
    └─────────────────────────────────────────────────────────────┘


REBOOT WORKFLOW:
================

    [Windows Restart/Reboot]
      |
      | System boots up
      v
    [Windows Startup]
      |
      | Wait 1 minute
      v
    ┌─────────────────────────────────────────────────────────────┐
    │   Task Scheduler - Startup Task                            │
    │   "PC-HIVE Auto Scanner - Startup"                         │
    └─────────────────────────────────────────────────────────────┘
      |
      | Launch scanner
      v
    [START_TRADING_BACKGROUND.bat]
      |
      | Scanner resumes automatically
      v
    [Back to Normal Operation]


DECISION TREE - TRADE EXECUTION:
=================================

    [Opportunity Found]
           |
           v
    ┌────────────────────┐
    │ Is it a weekday?   │
    │ (Mon-Fri)          │
    └────────────────────┘
           |
       YES |           NO
           v            └──> [SKIP - Weekend]
    ┌────────────────────┐
    │ Market hours?      │
    │ 6:30 AM - 1:00 PM? │
    └────────────────────┘
           |
       YES |           NO
           v            └──> [SKIP - Outside hours]
    ┌────────────────────┐
    │ Under daily limit? │
    │ (< 4 trades)       │
    └────────────────────┘
           |
       YES |           NO
           v            └──> [SKIP - Daily limit reached]
    ┌────────────────────┐
    │ Score >= 8.0?      │
    └────────────────────┘
           |
       YES |           NO
           v            └──> [SKIP - Score too low]
    ┌────────────────────┐
    │ EXECUTE TRADE      │
    │ Place order        │
    │ Log details        │
    │ Update counters    │
    └────────────────────┘
           |
           v
       [Complete]


FILE INTERACTION DIAGRAM:
==========================

    ┌─────────────────────────────────────────────────────────────┐
    │                    SYSTEM FILES                             │
    └─────────────────────────────────────────────────────────────┘

    Input Files:
    ────────────
    auto_options_scanner.py      → Main scanner code
    MONDAY_AI_TRADING.py         → Trading system
    .env                         → API credentials
    config/*.py                  → Configuration

    Output Files:
    ─────────────
    auto_scanner_status.json     ← Current status, trade counts
    logs/scanner_*.log           ← Detailed activity logs
    dual_strategy_execution_*.json ← Trade execution records

    Script Files:
    ─────────────
    START_TRADING.bat            → Manual visible start
    START_TRADING_BACKGROUND.bat → Automated background start
    CHECK_SCANNER_STATUS.bat     → Monitor status
    STOP_SCANNER.bat             → Stop gracefully
    EMERGENCY_STOP.bat           → Emergency kill
    VIEW_LATEST_LOG.bat          → View logs

    Setup Files:
    ────────────
    SETUP_AUTOMATED_STARTUP.bat  → Configure Task Scheduler
    TEST_SETUP.bat               → Verify configuration

    Documentation:
    ──────────────
    AUTOMATED_STARTUP_README.md  → Complete guide
    QUICK_START_AUTOMATION.txt   → Quick reference
    AUTOMATION_SUMMARY.txt       → Implementation summary
    AUTOMATION_WORKFLOW.txt      → This file


DATA FLOW:
==========

    Market Data (Alpaca API)
            |
            v
    auto_options_scanner.py
            |
            ├──> Scan S&P 500
            ├──> Calculate scores
            ├──> Filter opportunities
            └──> Execute trades
                    |
                    ├──> Trade orders (to Alpaca)
                    ├──> Status file (JSON)
                    └──> Log files (TXT)
                            |
                            v
                    User monitoring tools
                            |
                            ├──> CHECK_SCANNER_STATUS.bat
                            └──> VIEW_LATEST_LOG.bat


TIME-BASED SCHEDULE:
====================

    Daily:
    ──────
    6:30 AM PT  → Scanner starts automatically
                  Scans market
                  Executes trades (if opportunities)

    1:00 PM PT  → Market close
                  No more trading for today

    Next day    → Cycle repeats

    Weekly:
    ───────
    Monday      → Full week of trading begins
    Tuesday     → Normal trading
    Wednesday   → Normal trading
    Thursday    → Normal trading
    Friday      → Normal trading
    Saturday    → SKIP (no trading)
    Sunday      → SKIP (no trading)


SYSTEM STATE DIAGRAM:
=====================

    ┌─────────────────┐
    │     STOPPED     │ ◄── Initial state
    └─────────────────┘
            |
            | User runs SETUP_AUTOMATED_STARTUP.bat
            v
    ┌─────────────────┐
    │    SCHEDULED    │ ◄── Tasks created, waiting
    └─────────────────┘
            |
            | 6:30 AM PT or manual start
            v
    ┌─────────────────┐
    │     RUNNING     │ ◄── Active scanning
    └─────────────────┘
            |
            ├──> Error → Log → Continue → RUNNING
            ├──> No opportunities → Wait → RUNNING
            ├──> Execute trade → Log → RUNNING
            ├──> Daily limit reached → Wait → RUNNING
            ├──> User runs STOP_SCANNER.bat → STOPPED
            └──> User runs EMERGENCY_STOP.bat → LOCKED
                                                    |
                                                    v
                                            ┌─────────────────┐
                                            │     LOCKED      │
                                            │  (Emergency)    │
                                            └─────────────────┘
                                                    |
                                                    | User deletes flag
                                                    | Re-runs setup
                                                    v
                                            ┌─────────────────┐
                                            │    SCHEDULED    │
                                            └─────────────────┘


================================================================================
                        END OF WORKFLOW DIAGRAM
================================================================================
